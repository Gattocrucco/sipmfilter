import numpy as np
from matplotlib import pyplot as plt

import figlatex
import fingersnr

snrmax_output_8000 = (np.array([  32,   64,  128,  192,  256,  320,  384,  512,  768, 1024, 1536,
        2048]),
 np.array([[ 5.33500332,  7.44051436, 10.01739186, 11.81638624, 13.23181308,
         14.42289434, 15.08861206, 16.3312828 , 17.44561885, 19.04142599,
         19.05190571, 18.82526768],
        [ 5.50674603,  7.80933478, 10.29829173, 11.78134919, 12.93991883,
         13.52652164, 14.01200596, 14.73478927, 16.67852487, 16.84471577,
         18.03937004, 17.03765718],
        [ 5.13922187,  7.47870774,  9.94290249, 12.13225054, 13.28955735,
         14.32026412, 15.25161895, 16.9627286 , 18.46715486, 19.04115072,
         19.50390642, 19.4655877 ]]),
 np.array([[[  87.1484375 ,   97.        ,  111.3984375 ],
         [ 115.47851562,  137.5       ,  145.55664062],
         [ 168.68848181,  188.57751678,  227.6189558 ],
         [ 232.24609375,  253.        ,  289.56640625],
         [ 290.35917969,  331.1       ,  345.97363281],
         [ 358.76953125,  390.        ,  409.04296875],
         [ 401.328125  ,  440.        ,  468.359375  ],
         [ 511.04882812,  594.        ,  616.62304688],
         [ 640.29199219,  789.        ,  865.28027344],
         [ 956.89914701, 1002.93216636, 1107.73074234],
         [1088.421875  , 1312.        , 1618.859375  ],
         [1077.30957031, 1466.        , 2120.97558594]],
 
        [[  84.009375  ,  104.4       ,  281.390625  ],
         [ 131.45231569,  174.36162082,  311.26273716],
         [ 206.42483001,  264.8859974 ,  394.74221878],
         [ 223.41620942,  358.58651794,  465.74225475],
         [ 298.12265625,  373.2       ,  525.54140625],
         [ 304.98046875,  450.        ,  635.44921875],
         [ 334.90898437,  526.8       ,  651.81210937],
         [ 363.45585937,  680.4       ,  742.19414062],
         [ 506.97773438,  680.4       ,  867.11132813],
         [ 503.97617188,  885.2       , 1081.43085937],
         [ 663.96911868,  915.07991591, 1341.34272831],
         [ 668.66982024, 1198.10655455, 1548.52932124]],
 
        [[  19.        ,   32.        ,   45.        ],
         [  51.        ,   64.        ,   75.        ],
         [ 111.        ,  128.        ,  141.        ],
         [ 176.25      ,  192.        ,  204.75      ],
         [ 239.        ,  256.        ,  267.        ],
         [ 303.125     ,  320.        ,  334.375     ],
         [ 371.25      ,  384.        ,  398.25      ],
         [ 501.        ,  512.        ,  525.        ],
         [ 758.25      ,  768.        ,  777.75      ],
         [1007.        , 1024.        , 1037.        ],
         [1517.25      , 1536.        , 1547.25      ],
         [2029.        , 2048.        ,        np.nan]]]))

snrmax_output_1000 = (np.array([  32,   64,  128,  192,  256,  320,  384,  512,  768, 1024, 1536,
        2048]),
 np.array([[ 5.29327232,  7.16562916,  9.47841684, 11.07550326, 11.77031573,
         12.40311648, 12.86008773, 12.96397816, 12.80981868, 12.26085189,
         10.84343192, 10.75770574],
        [ 5.49415073,  7.40436605,  9.38366491, 10.03356433, 10.59436831,
         10.91362743, 10.95590798, 10.95038629, 10.64749766,  9.63269123,
          8.14248098,  6.51999903],
        [ 5.1008876 ,  7.25236461,  9.53025318, 10.94726541, 11.98107314,
         12.57994346, 13.29771937, 13.64043563, 13.90093887, 13.75495411,
         13.59383011, 13.5627842 ]]),
 np.array([[[  85.6328125 ,   97.        ,  114.4296875 ],
         [ 115.47851562,  137.5       ,  146.63085938],
         [ 167.21521996,  188.57751678,  229.09221765],
         [ 230.26953125,  253.        ,  287.58984375],
         [ 274.83886719,  331.1       ,  349.85371094],
         [ 346.58203125,  390.        ,  424.27734375],
         [ 399.609375  ,  440.        ,  478.671875  ],
         [ 483.81809204,  557.28878093,  627.49410587],
         [ 677.27636719,  789.        ,  880.69042969],
         [ 622.71337891, 1069.        , 1146.77392578],
         [ 414.49804688,  654.        , 1627.97460938],
         [ 809.26786488,  915.67988248, 1385.14466597]],
 
        [[  83.46766661,  139.65831799,  278.77109567],
         [ 131.46891058,  176.20963932,  311.80846332],
         [ 203.62455887,  272.20828757,  422.66716527],
         [ 212.45859375,  296.4       ,  499.59609375],
         [ 257.30390625,  373.2       ,  614.46796875],
         [ 269.82421875,  450.        ,  638.96484375],
         [ 273.17460937,  526.8       ,  684.73710938],
         [ 333.47734375,  475.6       ,  788.64140625],
         [ 399.33632813,  680.4       ,  912.29414063],
         [ 398.11949594,  632.05327728, 1152.38619988],
         [ 451.28452884,  915.07991591, 1339.55546285],
         [ 440.51476347, 1198.10655455, 1776.68437802]],
 
        [[  19.        ,   32.        ,   45.        ],
         [  51.        ,   64.        ,   75.        ],
         [ 111.        ,  128.        ,  141.        ],
         [ 173.25      ,  192.        ,  207.75      ],
         [ 237.68893184,  248.3606798 ,  270.67433463],
         [ 300.625     ,  320.        ,  338.125     ],
         [ 368.25      ,  384.        ,  399.75      ],
         [ 497.        ,  512.        ,  531.        ],
         [ 740.31210719,  760.3606798 ,  786.34957022],
         [ 993.        , 1024.        , 1057.        ],
         [1508.25      , 1536.        , 1565.25      ],
         [2021.        , 2048.        ,           np.nan]]]))

snrmax_output_200 = (np.array([  32,   64,  128,  192,  256,  320,  384,  512,  768, 1024, 1536,
        2048]),
 np.array([[5.08066805, 6.33635349, 7.83396546, 8.26164239, 8.40508151,
         8.33835527, 7.97626229, 7.55062506, 6.37808298, 5.67589238,
         4.31593227, 3.56753007],
        [4.98852384, 6.05151259, 6.58548856, 6.58711223, 6.22079895,
         5.9553177 , 5.61809644, 5.02909787, 4.18166421, 3.59264264,
         3.25327894, 0.        ],
        [4.93469841, 6.56086505, 7.95828732, 8.49564383, 8.47580044,
         8.81658614, 8.6180988 , 8.49954327, 7.69824622, 7.35194883,
         6.99275428, 6.82027724]]),
 np.array([[[  85.6328125 ,   97.        ,  111.3984375 ],
         [ 112.3046875 ,  125.        ,  151.3671875 ],
         [ 170.16174366,  188.57751678,  230.5654795 ],
         [ 220.38671875,  253.        ,  293.51953125],
         [ 277.67137798,  318.0486477 ,  358.42591743],
         [ 337.44140625,  390.        ,  430.37109375],
         [ 368.671875  ,  440.        ,  494.140625  ],
         [ 456.60672578,  557.28878093,  644.90938028],
         [ 415.30371094,  789.        ,  922.29785156],
         [ 537.10986328, 1069.        , 1169.74072266],
         [ 623.99414062, 1180.        , 1726.78710938],
         [ 641.89599609, 1629.        , 2243.85205078]],
 
        [[  82.66161197,  145.94050114,  291.31092219],
         [ 118.92606672,  173.97184618,  359.49651027],
         [ 166.95692972,  267.96848907,  470.51498374],
         [ 203.49823864,  343.86501051,  546.02002646],
         [ 222.31640625,  373.2       ,  652.37109375],
         [ 243.45703125,  450.        ,  707.51953125],
         [ 253.62539062,  526.8       ,  817.46601562],
         [ 268.45390625,  475.6       ,  942.83984375],
         [ 300.99726563,  680.4       , 1216.61367188],
         [ 313.79648438,  885.2       , 1325.20664063],
         [ 489.97558594, 1294.8       , 1512.91816406],
         [          np.nan, 3029.89344545,           np.nan]],
 
        [[  19.        ,   32.        ,   45.        ],
         [  51.        ,   64.        ,   75.        ],
         [ 111.8978195 ,  120.3606798 ,  140.10735383],
         [ 173.25      ,  192.        ,  207.75      ],
         [ 233.        ,  256.        ,  281.        ],
         [ 299.375     ,  320.        ,  344.375     ],
         [ 357.75      ,  384.        ,  410.25      ],
         [ 479.        ,  512.        ,  539.        ],
         [ 721.0060743 ,  760.3606798 ,  813.08100037],
         [ 977.65163047, 1016.3606798 , 1080.87576201],
         [1478.36059897, 1528.3606798 , 1585.82345927],
         [1989.55091678, 2040.3606798 ,           np.nan]]]))

###########################

fig = plt.figure(num='figchangebs', clear=True, figsize=[9.9, 5])

axs = fingersnr.snrmaxplot_multiple(fig, [snrmax_output_8000, snrmax_output_1000, snrmax_output_200])
for nbs, ax in zip([8000, 1000, 200], axs[0]):
    ax.set_title(f'{nbs} baseline samples')

fig.tight_layout()
fig.show()

figlatex.save(fig)
